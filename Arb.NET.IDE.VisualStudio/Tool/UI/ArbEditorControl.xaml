<UserControl x:Class="Arb.NET.IDE.VisualStudio.Tool.UI.ArbEditorControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vsui="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0">
    <UserControl.Resources>
        <Style TargetType="DataGridRow">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="BorderBrush"
                            Value="{DynamicResource {x:Static vsui:EnvironmentColors.SystemHighlightBrushKey}}" />
                    <Setter Property="BorderThickness" Value="0,1" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="DataGridCell">
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}" />
            <Setter Property="BorderBrush"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBorderBrushKey}}" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background"
                            Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}" />
                    <Setter Property="Foreground"
                            Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="4,2" />
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}" />
            <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}" />
        </Style>
    </UserControl.Resources>
    
    <Grid Background="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Directory selector -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="6,6,6,4">
            <Label Content="Directory:"
                   VerticalAlignment="Center"
                   Foreground="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}" />
            <ComboBox x:Name="DirectoryCombo"
                      MinWidth="320"
                      VerticalAlignment="Center"
                      SelectionChanged="DirectoryCombo_OnSelectionChanged">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <Button Content="Add Locale"
                    Margin="8,0,0,0"
                    Padding="8,2"
                    VerticalAlignment="Center"
                    Click="AddLocaleButton_OnClick" />
            <Button Content="Add Key"
                    Margin="4,0,0,0"
                    Padding="8,2"
                    VerticalAlignment="Center"
                    Click="AddKeyButton_OnClick" />
            <Button Content="Remove Key"
                    Margin="4,0,0,0"
                    Padding="8,2"
                    VerticalAlignment="Center"
                    Click="RemoveKeyButton_OnClick" />
            <Button Content="Translate..."
                    Margin="8,0,0,0"
                    Padding="8,2"
                    VerticalAlignment="Center"
                    Click="TranslateButton_OnClick" />
            <Button Content="AI Settings..."
                    Margin="4,0,0,0"
                    Padding="8,2"
                    VerticalAlignment="Center"
                    Click="AiSettingsButton_OnClick" />
        </StackPanel>

        <!-- Loading overlay -->
        <TextBlock x:Name="LoadingLabel"
                   Grid.Row="1"
                   Text="Loading ARB dataâ€¦"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   FontSize="14"
                   Foreground="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}"
                   Visibility="Visible" />

        <!-- ARB data grid -->
        <DataGrid x:Name="ArbGrid"
                  Grid.Row="1"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserReorderColumns="True"
                  CanUserSortColumns="True"
                  HeadersVisibility="Column"
                  GridLinesVisibility="All"
                  SelectionUnit="FullRow"
                  SelectionMode="Extended"
                  Background="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"
                  Foreground="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}"
                  RowBackground="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"
                  AlternatingRowBackground="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"
                  HorizontalGridLinesBrush="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBorderBrushKey}}"
                  VerticalGridLinesBrush="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBorderBrushKey}}"
                  Visibility="Collapsed"
                  CellEditEnding="ArbGrid_OnCellEditEnding"
                  PreviewKeyDown="ArbGrid_OnPreviewKeyDown">
            <DataGrid.ContextMenu>
                <ContextMenu Opened="GridContextMenu_OnOpened">
                    <MenuItem x:Name="RenameMenuItem" Header="Rename" Click="RenameMenuItem_OnClick" />
                    <MenuItem x:Name="DeleteKeyMenuItem" Header="Remove Key" Click="RemoveKeyMenuItem_OnClick" />
                    <MenuItem Header="Translate Selected" Click="TranslateSelectedMenuItem_OnClick" />
                </ContextMenu>
            </DataGrid.ContextMenu>
        </DataGrid>
    </Grid>
</UserControl>